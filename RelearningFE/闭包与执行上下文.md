### 闭包与执行上下文

#### 常见概念
* 闭包
* 作用域链
* 执行上下文
* this值

#### 闭包
古典闭包的定义
* 环境部分
  * 环境
  * 标识符列表
* 表达式部分

对应到js中，对应闭包的部分：
* 环境部分
 * 环境：函数的词法环境（执行上下文的一部分）
 * 标志符列表：函数中用到的未声明的变量
* 表达式部分：函数体

常见误区，把js执行上下文或者作用域概念当作闭包。

其实在js中，闭包对应的就是函数--常见--能够读取其他函数内部变量的函数。

#### 执行上下文
js中把一段代码（包括函数），执行所需的所有信息定义为：‘执行上下文’，执行上下文的演进：

ES3:
* scope：作用域，也常常被叫做作用域链
* varible object：变量对象，用于存储变量的对象
* this value：this值

ES5改进了命名方式，把执行上下文最初的部分改进如下：
* lexical environment：词法环境，当获取变量时使用
* varible environment：变量环境，当声明变量时使用
* this value：this值

ES2018中，执行上下文添加了更多内容：
* lexical environment：词法环境，当获取变量或者this值时使用
* varible environment：变量环境，当声明变量时使用
* code evaluation state：用于恢复代码执行位置
* Function：执行的任务是函数时使用，表示正在被执行的函数
* ScriptOrModule：执行的任务是脚本或者模块时使用，表示正在被执行的代码
* Realm：使用的基础库和内置对象实例
* Generator：仅生成器上下文具有此属性，表示当前生成器

#### var
var声明是旧js时代的声明方式，var声明会穿透for、if等语句。let产生以前我们会利用立即执行函数来构造新的域，从而控制var的范围。使用立即执行函数要记得在括号前加 ‘;’ ,不然会被上次的函数调用当作执行，推荐的立即执行函数写法：
```
void function() {
  var a
}
```
通过void关键字忽略表达式后面的值，同时控制了var的范围



